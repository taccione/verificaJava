// Diego Renesto
// molti comandi sono stati eseguiti dal compiler. siccome mi dava errore, mi sono posizionato con il puntatore e con alt+masiusc+invio ha corretto il programma, nel codice ho segnato dove
// ho successivamente cercato a cosa servisse quel comando
import java.util.ArrayList;
import java.util.Scanner;

class Contatto {
    String nome; // nome del contatto
    String cognome; // cognome del contatto
    String numero; // numero di telefono del contatto
    boolean nascosto; // il contatto Ã¨ nascosto si o no

    Contatto(String nome, String cognome, String numero, boolean nascosto) {
        this.nome = nome;
        this.cognome = cognome;
        this.numero = numero;
        this.nascosto = nascosto;
    }

    public String toString() {  // metodo per stampare il contatto a patto che non sia nascosto
        if (nascosto) {
            return "Contatto nascosto.";
        } else {
            return "Nome: " + nome + ", Cognome: " + cognome + ", Numero: " + numero;
        }
    }
}

public class RubTelefonica {
    static ArrayList<Contatto> contatti = new ArrayList<>();
    static ArrayList<String> ultimeChiamate = new ArrayList<>();
    static Scanner tastiera = new Scanner(System.in);
    static String password = "1234"; // password per sbloccare i contatti nascosti

    public static void main(String[] args) {
        Scanner tastiera = new Scanner(System.in);
        while (true) {
            System.out.println("1. Gestione Rubrica");
            System.out.println("2. Gestione Chiamate");
            System.out.println("3. Esci");
            int scelta = tastiera.nextInt();
            tastiera.nextLine(); // azzero il buffer
            switch (scelta) {
                case 1:
                    gestioneRubrica();
                    break;
                case 2:
                    gestioneChiamate();
                    break;
                case 3:
                    System.exit(0);
                default:
                    System.out.println("Scelta non valida.");
            }
        }
    }

    // PRIMA PARTE DEL SOFTWARE
    // inserimento, modifica ed eliminazione del contatto nella rubrica
    public static void gestioneRubrica() {
        Scanner tastiera = new Scanner(System.in);
        System.out.println("1. Aggiungi Contatto");
        System.out.println("2. Modifica Contatto");
        System.out.println("3. Elimina Contatto");
        System.out.println("4. Visualizza Contatti");
        int scelta = tastiera.nextInt();
        tastiera.nextLine(); // azzero il buffer
        switch (scelta) {
            case 1:
                aggiungiContatto();
                break;
            case 2:
                modificaContatto();
                break;
            case 3:
                eliminaContatto();
                break;
            case 4:
                visualizzaContatti();
                break;
            default:
                System.out.println("Scelta non valida.");
        }
    }

    public static void aggiungiContatto() {
        Scanner tastiera = new Scanner(System.in);
        System.out.print("Inserisci nome: ");
        String nome = tastiera.nextLine();
        System.out.print("Inserisci cognome: ");
        String cognome = tastiera.nextLine();
        System.out.print("Inserisci numero di telefono: ");
        String numero = tastiera.nextLine();
        System.out.print("Vuoi nascondere il contatto? (s/n): ");
        boolean nascosto = tastiera.nextLine().equalsIgnoreCase("s"); // alt+maiusc+invio
        RubTelefonica.contatti.add(new Contatto(nome, cognome, numero, nascosto)); // vado a prendere contatto e lo aggiungo nella rubrica
    }

    public static void modificaContatto() {
        Scanner tastiera = new Scanner(System.in);
        System.out.print("Inserisci il nome del contatto da modificare: ");
        String nome = tastiera.nextLine();
        // ricerca di contatto all'interno della rubrica, funzione svolta dal compiler con alt+maiusc+invio
        for (Contatto contatto : RubTelefonica.contatti) {
            if (contatto.nome.equals(nome)) { // contatto trovato
                System.out.print("Inserisci nuovo cognome: ");
                contatto.cognome = tastiera.nextLine();
                System.out.print("Inserisci nuovo numero di telefono: ");
                contatto.numero = tastiera.nextLine();
                System.out.print("Vuoi nascondere il contatto? (s/n): ");
                contatto.nascosto = tastiera.nextLine().equalsIgnoreCase("s");
                return;
            }
        }
        System.out.println("Contatto non trovato.");
    }

    public static void eliminaContatto() { // metodo per eliminare un contatto creato
        Scanner tastiera = new Scanner(System.in);
        System.out.print("Inserisci il nome del contatto da eliminare: ");
        String nome = tastiera.nextLine();
        RubTelefonica.contatti.removeIf(contatto -> contatto.nome.equals(nome)); // alt+maiusc+invio
    }

    static void visualizzaContatti() { // stampa del contatto
        for (Contatto contatto : RubTelefonica.contatti) {
            System.out.println(contatto);
        }
    }

    // SECONDA PARTE DEL SOFTWARE
    // gestione chiamate nella rubrica
    public static void gestioneChiamate() {
        Scanner tastiera = new Scanner(System.in);
        System.out.println("1. Aggiungi Chiamata");
        System.out.println("2. Visualizza Ultime Chiamate");
        int scelta = tastiera.nextInt();
        tastiera.nextLine(); // Consuma newline
        switch (scelta) {
            case 1:
                aggiungiChiamata();
                break;
            case 2:
                visualizzaUltimeChiamate();
                break;
            default:
                System.out.println("Scelta non valida.");
        }
    }

    public static void aggiungiChiamata() {
        Scanner tastiera = new Scanner(System.in);
        System.out.print("Inserisci numero chiamato: ");
        String numero = tastiera.nextLine();
        RubTelefonica.ultimeChiamate.add(numero);
    }

    public static void visualizzaUltimeChiamate() {
        Scanner tastiera = new Scanner(System.in);
        for (String chiamata : RubTelefonica.ultimeChiamate) {
            boolean trovato = false;
            for (Contatto contatto : RubTelefonica.contatti) {
                if (contatto.numero.equals(chiamata)) {
                    if (contatto.nascosto) {
                        System.out.print("Inserisci la password per visualizzare il contatto: ");
                        String inputPassword = tastiera.nextLine();
                        if (inputPassword.equals(RubTelefonica.password)) {
                            System.out.println(contatto);
                        } else {
                            System.out.println("Password errata.");
                        }
                    } else {
                        System.out.println(contatto);
                    }
                    trovato = true;
                    break;
                }
            }
            if (!trovato) {
                System.out.println("Numero: " + chiamata);
            }
        }
    }
}
